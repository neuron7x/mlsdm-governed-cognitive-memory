name: Documentation

on:
  push:
    branches: [ main ]
    paths:
      - '**.md'
      - 'docs/**'
      - '.github/workflows/docs.yml'
  pull_request:
    branches: [ main ]
    paths:
      - '**.md'
      - 'docs/**'
  workflow_dispatch:

permissions:
  contents: read

jobs:
  check-docs:
    name: Check Documentation
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'

      - name: Check markdown links
        uses: gaurav-nelson/github-action-markdown-link-check@1.0.15
        with:
          use-quiet-mode: 'yes'
          use-verbose-mode: 'no'
          config-file: '.github/markdown-link-check-config.json'
        continue-on-error: true

      - name: Check documentation completeness
        run: |
          echo "Checking for required documentation files..."
          required_files=(
            "README.md"
            "CONTRIBUTING.md"
            "LICENSE"
            "SECURITY_POLICY.md"
            "API_REFERENCE.md"
            "USAGE_GUIDE.md"
          )
          
          missing_files=()
          for file in "${required_files[@]}"; do
            if [ ! -f "$file" ]; then
              missing_files+=("$file")
            fi
          done
          
          if [ ${#missing_files[@]} -gt 0 ]; then
            echo "Missing documentation files:"
            printf '%s\n' "${missing_files[@]}"
            exit 1
          else
            echo "All required documentation files are present."
          fi
