pytest --ignore=tests/load
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /home/runner/work/mlsdm/mlsdm
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
testpaths: tests
plugins: hypothesis-6.148.7, locust-2.42.6, anyio-4.12.0, cov-7.0.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 3418 items / 2 skipped

tests/adapters/test_adapters.py ...................................      [  1%]
tests/api/test_api_contract.py ................                          [  1%]
tests/api/test_health.py ..............                                  [  1%]
tests/api/test_http_contracts.py ..........................              [  2%]
tests/api/test_infer_contract.py .................                       [  3%]
tests/api/test_middleware_reliability.py ..................              [  3%]
tests/chaos/test_memory_pressure.py .....                                [  3%]
tests/chaos/test_network_timeout.py .......                              [  4%]
tests/chaos/test_slow_llm.py .....                                       [  4%]
tests/contracts/test_engine_contracts.py ............................... [  5%]
.                                                                        [  5%]
tests/contracts/test_no_secrets_in_logs.py ..............                [  5%]
tests/contracts/test_policy_workflow_alignment.py ..........             [  5%]
tests/contracts/test_speech_contracts.py ........................        [  6%]
tests/core/test_cognitive_state_introspection.py ...................     [  7%]
tests/core/test_speech_governance_hook.py .........                      [  7%]
tests/e2e/test_e2e_scenarios.py ................                         [  7%]
tests/e2e/test_end_to_end_core.py .....                                  [  7%]
tests/e2e/test_full_stack.py ........                                    [  8%]
tests/e2e/test_http_inference_api.py ......................              [  8%]
tests/e2e/test_neuro_cognitive_engine_stub_backend.py .......            [  9%]
tests/e2e/test_observability_e2e.py ..........                           [  9%]
tests/eval/test_aphasia_eval_suite.py .......                            [  9%]
tests/eval/test_canary_manager.py ..............                         [  9%]
tests/eval/test_llm_ab_testing.py .........                              [ 10%]
tests/eval/test_sapolsky_suite.py ..............                         [ 10%]
tests/evals/test_moral_filter_eval_smoke.py ..............               [ 11%]
tests/examples/test_minimal_example.py .                                 [ 11%]
tests/examples/test_production_chatbot_example.py .                      [ 11%]
tests/experimental/test_fractal_pelm_gpu.py ............................ [ 11%]
.....                                                                    [ 12%]
tests/extensions/test_aphasia_edge_cases.py ...........................  [ 12%]
tests/extensions/test_aphasia_speech_governor.py ............            [ 13%]
tests/extensions/test_neurolang_aphasia_pipeline_integration.py ......   [ 13%]
tests/extensions/test_neurolang_modes.py ........                        [ 13%]
tests/integration/test_api_with_adapters.py ........                     [ 13%]
tests/integration/test_cli.py .................                          [ 14%]
tests/integration/test_end_to_end.py .                                   [ 14%]
tests/integration/test_http_api.py .................                     [ 14%]
tests/integration/test_llm_pipeline_integration.py ...............       [ 15%]
tests/integration/test_llm_wrapper_integration.py ........               [ 15%]
tests/integration/test_metrics_with_multi_llm.py ..........              [ 15%]
tests/integration/test_neuro_cognitive_engine.py s...........s.          [ 16%]
tests/integration/test_neuro_engine_http_api.py ...............          [ 16%]
tests/integration/test_neurolang_wrapper.py .....                        [ 16%]
tests/integration/test_public_api.py ..........................          [ 17%]
tests/integration/test_real_llm.py ...............                       [ 18%]
tests/integration/test_role_boundary_controller_integration.py ........  [ 18%]
tests/observability/test_aphasia_logging.py ......                       [ 18%]
tests/observability/test_aphasia_metrics.py .........                    [ 18%]
tests/observability/test_aphasia_telemetry_integration.py .............. [ 19%]
.                                                                        [ 19%]
tests/observability/test_emergency_logging.py .........                  [ 19%]
tests/observability/test_enhanced_metrics.py ...............             [ 19%]
tests/observability/test_memory_observability.py ....................... [ 20%]
.......                                                                  [ 20%]
tests/observability/test_metrics_and_tracing_integration.py ............ [ 21%]
.........                                                                [ 21%]
tests/observability/test_metrics_basic.py ..............                 [ 21%]
tests/observability/test_metrics_integration.py ........................ [ 22%]
..........                                                               [ 22%]
tests/observability/test_metrics_prometheus_integration.py ............. [ 23%]
.................                                                        [ 23%]
tests/observability/test_new_metrics.py ...................              [ 24%]
tests/observability/test_production_observability.py ................... [ 24%]
...                                                                      [ 24%]
tests/observability/test_tracing_integration.py .....................    [ 25%]
tests/observability/test_tracing_no_otel.py .......                      [ 25%]
tests/observability/test_tracing_pipeline_integration.py ..............  [ 26%]
tests/observability/test_tracing_smoke.py ssssssssssssssssssss           [ 26%]
tests/packaging/test_neurolang_optional_dependency.py ....               [ 26%]
tests/packaging/test_package_smoke.py ....................               [ 27%]
tests/perf/test_golden_path_perf.py ....                                 [ 27%]
tests/perf/test_slo_api_endpoints.py ......                              [ 27%]
tests/property/test_cognitive_controller_integration.py .........        [ 27%]
tests/property/test_concurrency_safety.py .........                      [ 28%]
tests/property/test_counterexamples_regression.py ............           [ 28%]
tests/property/test_global_memory_invariant.py ......................... [ 29%]
.                                                                        [ 29%]
tests/property/test_invariants_cognitive_rhythm.py .................     [ 29%]
tests/property/test_invariants_llm_wrapper.py .......................... [ 30%]
                                                                         [ 30%]
tests/property/test_invariants_memory.py ...........................     [ 31%]
tests/property/test_invariants_neuro_engine.py .....................     [ 31%]
tests/property/test_moral_filter_properties.py ............              [ 32%]
tests/property/test_multilevel_synaptic_memory_properties.py ........... [ 32%]
.                                                                        [ 32%]
tests/property/test_pelm_phase_behavior.py .........                     [ 32%]
tests/resilience/test_bulkhead_integration.py ..........                 [ 33%]
tests/resilience/test_fault_tolerance.py ........................        [ 33%]
tests/resilience/test_llm_failures.py ........                           [ 34%]
tests/resilience/test_rate_limiting.py ...........                       [ 34%]
tests/runtime/test_runtime_smoke.py ....................                 [ 35%]
tests/safety/test_content_safety.py ...................                  [ 35%]
tests/safety/test_memory_leakage.py .............                        [ 35%]
tests/scripts/test_ci_perf_resilience_gate.py .......................... [ 36%]
.....                                                                    [ 36%]
tests/scripts/test_run_aphasia_eval.py ...                               [ 36%]
tests/scripts/test_scripts_smoke.py .......                              [ 37%]
tests/scripts/test_smoke_neurolang_wrapper.py ..                         [ 37%]
tests/scripts/test_train_neurolang_grammar.py ..                         [ 37%]
tests/sdk/test_neuro_engine_client.py .................................. [ 38%]
..                                                                       [ 38%]
tests/security/test_adversarial_inputs.py ...........................    [ 39%]
tests/security/test_ai_safety_invariants.py .......................      [ 39%]
tests/security/test_aphasia_logging_privacy.py ......                    [ 39%]
tests/security/test_guardrails_stride.py .....................           [ 40%]
tests/security/test_llm_safety.py ................................       [ 41%]
tests/security/test_neurolang_checkpoint_security.py .....               [ 41%]
tests/security/test_payload_scrubber.py ................................ [ 42%]
.........................................                                [ 43%]
tests/security/test_rbac_api.py ......................                   [ 44%]
tests/security/test_robustness.py .................                      [ 44%]
tests/security/test_secure_mode.py ...................                   [ 45%]
tests/security/test_security_invariants.py ...............               [ 45%]
tests/speech/test_pipeline_speech_governor.py .........                  [ 46%]
tests/state/test_system_state_integrity.py ............................. [ 47%]
..                                                                       [ 47%]
tests/tools/test_validate_manifests.py ......                            [ 47%]
tests/tools/test_validate_policy_config.py ..                            [ 47%]
tests/tools/test_verify_core_implementation.py ..........                [ 47%]
tests/unit/security/test_guardrails_orchestrator.py .................    [ 48%]
tests/unit/security/test_policy_engine.py .............................. [ 49%]
                                                                         [ 49%]
tests/unit/test_aphasia_config.py ............                           [ 49%]
tests/unit/test_api_health.py ......................                     [ 50%]
tests/unit/test_api_health_models.py ..........                          [ 50%]
tests/unit/test_array_pool.py .................                          [ 50%]
tests/unit/test_bulkhead.py .........................                    [ 51%]
tests/unit/test_cache_utils.py ....................................      [ 52%]
tests/unit/test_canary_manager.py ...................................... [ 53%]
............                                                             [ 54%]
tests/unit/test_circuit_breaker.py ..................................... [ 55%]
........                                                                 [ 55%]
tests/unit/test_cli.py ................................                  [ 56%]
tests/unit/test_cognitive_controller.py ............................     [ 57%]
tests/unit/test_coherence_safety_metrics.py ............................ [ 57%]
...................                                                      [ 58%]
tests/unit/test_config_cache.py ................                         [ 58%]
tests/unit/test_config_loader.py .............................           [ 59%]
tests/unit/test_config_loader_comprehensive.py ......................... [ 60%]
..                                                                       [ 60%]
tests/unit/test_config_validation.py ................................... [ 61%]
......................                                                   [ 62%]
tests/unit/test_config_validator_comprehensive.py ...................... [ 62%]
......................................                                   [ 64%]
tests/unit/test_data_serializer.py ..............                        [ 64%]
tests/unit/test_embedding_cache.py ..........................            [ 65%]
tests/unit/test_engine_factory.py .............                          [ 65%]
tests/unit/test_engine_from_config.py ...........                        [ 65%]
tests/unit/test_errors.py ................................               [ 66%]
tests/unit/test_exporters.py ..........                                  [ 67%]
tests/unit/test_input_validator.py ..................................... [ 68%]
.................                                                        [ 68%]
tests/unit/test_input_validator_edge_cases.py .....................      [ 69%]
tests/unit/test_llm_pipeline.py .....................................    [ 70%]
tests/unit/test_llm_provider.py .....................sssss.sssss         [ 71%]
tests/unit/test_llm_provider_errors.py ............                      [ 71%]
tests/unit/test_llm_provider_exceptions.py ...........                   [ 72%]
tests/unit/test_llm_router.py ..............                             [ 72%]
tests/unit/test_llm_safety_comprehensive.py ............................ [ 73%]
..                                                                       [ 73%]
tests/unit/test_llm_wrapper_reliability.py ................              [ 73%]
tests/unit/test_memory_manager.py ......................                 [ 74%]
tests/unit/test_metrics_collector.py ........................            [ 75%]
tests/unit/test_metrics_registry.py ..........                           [ 75%]
tests/unit/test_middleware.py ...............                            [ 75%]
tests/unit/test_moral_filter.py ..................                       [ 76%]
tests/unit/test_mtls.py ...........                                      [ 76%]
tests/unit/test_mtls_comprehensive.py .........................          [ 77%]
tests/unit/test_multi_level_memory.py .............................      [ 78%]
tests/unit/test_multi_level_memory_calibration.py ...................... [ 78%]
                                                                         [ 78%]
tests/unit/test_neuro_cognitive_engine.py .............................. [ 79%]
.....                                                                    [ 79%]
tests/unit/test_neuro_engine_client.py .............                     [ 80%]
tests/unit/test_observability_logger.py ................................ [ 81%]
........                                                                 [ 81%]
tests/unit/test_observability_logger_comprehensive.py .................. [ 82%]
................................                                         [ 82%]
tests/unit/test_observability_metrics.py ..............................  [ 83%]
tests/unit/test_oidc.py .................                                [ 84%]
tests/unit/test_oidc_comprehensive.py ...........................        [ 85%]
tests/unit/test_ontology_matcher_comprehensive.py ...................... [ 85%]
....                                                                     [ 85%]
tests/unit/test_payload_scrubber.py .................................    [ 86%]
tests/unit/test_payload_scrubber_comprehensive.py ...................... [ 87%]
...................                                                      [ 88%]
tests/unit/test_pelm.py ...........................................      [ 89%]
tests/unit/test_pelm_batch.py .................                          [ 89%]
tests/unit/test_provider_factory.py ....................ss..             [ 90%]
tests/unit/test_qilm_module.py .................                         [ 90%]
tests/unit/test_qilm_v2.py ............................                  [ 91%]
tests/unit/test_rate_limit.py ..................                         [ 92%]
tests/unit/test_rate_limiter.py ........................                 [ 93%]
tests/unit/test_rbac.py ................................                 [ 93%]
tests/unit/test_role_boundary_controller.py ............................ [ 94%]
.                                                                        [ 94%]
tests/unit/test_security_logger.py .......................               [ 95%]
tests/unit/test_signing.py .......................                       [ 96%]
tests/unit/test_signing_comprehensive.py ............................... [ 97%]
                                                                         [ 97%]
tests/unit/test_synergy_experience.py .................................. [ 98%]
..........                                                               [ 98%]
tests/unit/test_tracing.py .......................                       [ 99%]
tests/validation/test_aphasia_detection.py .............                 [ 99%]
tests/validation/test_moral_filter_effectiveness.py .....                [ 99%]
tests/validation/test_rhythm_state_machine.py ...........                [ 99%]
tests/validation/test_wake_sleep_effectiveness.py ....                   [100%]

=============================== warnings summary ===============================
tests/safety/test_memory_leakage.py::TestMemoryContentSafety::test_extreme_magnitude_vectors
  /home/runner/work/mlsdm/mlsdm/.venv/lib/python3.12/site-packages/numpy/linalg/_linalg.py:2792: RuntimeWarning: overflow encountered in dot
    sqnorm = x.dot(x)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========== 3384 passed, 36 skipped, 1 warning in 544.87s (0:09:04) ============
