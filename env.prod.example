# MLSDM Production Mode Environment Configuration
# =================================================
#
# Copy this file to .env.prod and customize for your production environment.
# Use with: MLSDM_RUNTIME_MODE=cloud-prod
#
# This mode enables:
# - Full security hardening (OIDC, mTLS, RBAC, signing, policy engine, guardrails)
# - PII scrubbing in logs
# - Multi-tenant enforcement
# - Distributed tracing
# - JSON structured logging

# ============================================================
# Runtime Mode
# ============================================================
MLSDM_RUNTIME_MODE=cloud-prod

# ============================================================
# Server Configuration
# ============================================================
HOST=0.0.0.0
PORT=8443
MLSDM_WORKERS=4
MLSDM_RELOAD=false
MLSDM_LOG_LEVEL=info
MLSDM_TIMEOUT_KEEP_ALIVE=60

# ============================================================
# Security - Basic
# ============================================================
# API key for basic authentication (REQUIRED in production)
API_KEY=<your-api-key-from-secrets-manager>

# Rate limiting (enabled in production)
MLSDM_RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# Secure mode (training disabled)
MLSDM_SECURE_MODE=1

# CORS origins (comma-separated)
# MLSDM_CORS_ORIGINS=https://app.example.com,https://admin.example.com

# ============================================================
# Security - Advanced Features (v1.1)
# ============================================================

# OIDC Authentication (SEC-004)
# Enable for enterprise SSO integration
MLSDM_SECURITY_ENABLE_OIDC=1
MLSDM_OIDC_DISCOVERY_URL=https://your-idp.example.com/.well-known/openid-configuration
MLSDM_OIDC_CLIENT_ID=<your-client-id>
MLSDM_OIDC_CLIENT_SECRET=<your-client-secret>
MLSDM_OIDC_AUDIENCE=mlsdm-api

# Mutual TLS (SEC-006)
# Enable for zero-trust network security
MLSDM_SECURITY_ENABLE_MTLS=1
MLSDM_MTLS_CA_CERT=/path/to/ca-bundle.crt
MLSDM_MTLS_REQUIRE_CLIENT_CERT=true
MLSDM_MTLS_VERIFY_DEPTH=3

# Role-Based Access Control
# Enable for fine-grained permissions
MLSDM_SECURITY_ENABLE_RBAC=1

# Request Signing
# Enable for API request integrity verification
MLSDM_SECURITY_ENABLE_REQUEST_SIGNING=1
MLSDM_SIGNING_KEY=<your-hmac-signing-key>
MLSDM_SIGNING_ALGORITHM=HS256

# Policy-as-Code Engine
# Enable for declarative security policies
MLSDM_SECURITY_ENABLE_POLICY_ENGINE=1

# LLM Output Guardrails
# Enable for content filtering and safety
MLSDM_SECURITY_ENABLE_GUARDRAILS=1

# LLM Safety Analysis
# Enable for prompt/response safety checks
MLSDM_SECURITY_ENABLE_LLM_SAFETY=1

# PII Scrubbing in Logs
# Enable to redact sensitive data from logs
MLSDM_SECURITY_ENABLE_PII_SCRUB_LOGS=1

# Multi-Tenant Data Isolation
# Enable for SaaS deployments with tenant separation
MLSDM_SECURITY_ENABLE_MULTI_TENANT_ENFORCEMENT=1

# ============================================================
# Observability
# ============================================================
LOG_LEVEL=INFO
JSON_LOGGING=true
ENABLE_METRICS=true

# OpenTelemetry Tracing (enabled in production)
OTEL_SDK_DISABLED=false
OTEL_TRACING_ENABLED=true
OTEL_EXPORTER_TYPE=otlp
OTEL_SERVICE_NAME=mlsdm-api
OTEL_EXPORTER_OTLP_ENDPOINT=https://otel-collector.example.com:4317

# ============================================================
# Engine Configuration
# ============================================================
# Production LLM backend (configure your provider)
LLM_BACKEND=openai
OPENAI_API_KEY=<your-openai-api-key>
OPENAI_MODEL=gpt-4

# Use production config
CONFIG_PATH=config/production.yaml

# Embedding dimensions (must match model)
EMBEDDING_DIM=384

# Enable FSLGS (Finite State Language Grammar System)
ENABLE_FSLGS=true

# ============================================================
# Secrets Management
# ============================================================
# In production, use a secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)
# instead of environment variables for sensitive values.
#
# Example with AWS Secrets Manager:
# - Store secrets in AWS Secrets Manager
# - Use IAM roles for EC2/ECS to access secrets
# - Inject secrets at runtime via init containers or parameter store
#
# Example with Vault:
# - Store secrets in HashiCorp Vault
# - Use Vault agent to inject secrets
# - Rotate secrets automatically

# ============================================================
# Notes
# ============================================================
# - Never commit .env files with real credentials to version control
# - Use HTTPS/TLS for all API traffic (configure at load balancer or reverse proxy)
# - Rotate API keys, signing keys, and certificates regularly
# - Monitor security logs and set up alerts for anomalies
# - Test security configuration in staging before production deployment
# - See SECURITY_POLICY.md for complete security guidelines
# - See DEPLOYMENT_GUIDE.md for production deployment best practices
